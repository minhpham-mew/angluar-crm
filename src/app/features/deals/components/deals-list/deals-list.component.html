<div class="flex flex-col gap-y-6">
  <!-- Header -->
  <div class="flex justify-between items-center">
    <div>
      <h1 class="text-2xl font-bold text-gray-900">Deals</h1>
      <p class="mt-1 text-sm text-gray-600">
        Track your sales pipeline and manage deal opportunities.
      </p>
    </div>
    <p-button label="Add Deal" icon="pi pi-plus" severity="primary" (onClick)="openAddDealDialog()">
    </p-button>
  </div>

  <!-- Pipeline Value Summary -->
  @if (pipelineValue$ | async; as pipelineValue) {
  <div class="bg-white p-6 rounded-lg shadow">
    <div class="flex items-center">
      <div class="flex-shrink-0">
        <i class="pi pi-dollar text-2xl text-green-500"></i>
      </div>
      <div class="ml-4">
        <h3 class="text-lg font-medium text-gray-900">Total Pipeline Value</h3>
        <p class="text-3xl font-bold text-green-600">${{ pipelineValue | number : '1.2-2' }}</p>
      </div>
    </div>
  </div>
  }

  <!-- Search -->
  <app-deal-search
    [searchTerm]="(searchTerm$ | async) || ''"
    (searchChange)="onSearchChange($event)"
  >
  </app-deal-search>

  <!-- Deals Table -->
  <app-deal-table
    [deals]="(deals$ | async) || []"
    [loading]="(loading$ | async) || false"
    [error]="error$ | async"
    (addDeal)="openAddDealDialog()"
    (editDeal)="openEditDealDialog($event)"
    (deleteDeal)="confirmDeleteDeal($event)"
  >
  </app-deal-table>

  <!-- Deal Form Dialog -->
  <app-deal-form
    [visible]="displayDealDialog"
    [selectedDeal]="selectedDeal()"
    (dialogHide)="closeDealDialog()"
    (dealSave)="saveDeal($event)"
  >
  </app-deal-form>
</div>

<!-- Confirmation Dialog -->
<p-confirmDialog></p-confirmDialog>
