<p-dialog 
  [visible]="visible()" 
  [header]="selectedDeal() ? 'Edit Deal' : 'Add New Deal'"
  [modal]="true" 
  [style]="{width: '500px'}"
  [closable]="true"
  [draggable]="false"
  [resizable]="false"
  (onHide)="onDialogHide()">
  
  <form [formGroup]="dealForm" (ngSubmit)="onSubmit()">
    <div class="field">
      <label for="title" class="block text-sm font-medium text-gray-700 mb-2">Deal Title *</label>
      <input 
        pInputText 
        id="title" 
        formControlName="title"
        placeholder="Enter deal title"
        class="w-full"
        [class.ng-invalid]="dealForm.get('title')?.invalid && dealForm.get('title')?.touched" />
      @if (dealForm.get('title')?.invalid && dealForm.get('title')?.touched) {
        <small class="p-error">Title is required</small>
      }
    </div>
    
    <div class="field">
      <label for="description" class="block text-sm font-medium text-gray-700 mb-2">Description</label>
      <textarea 
        id="description" 
        formControlName="description"
        rows="3"
        placeholder="Enter deal description"
        class="p-inputtext p-component w-full">
      </textarea>
    </div>
    
    <div class="grid grid-cols-2 gap-4">
      <div class="field">
        <label for="value" class="block text-sm font-medium text-gray-700 mb-2">Value *</label>
        <p-inputNumber
          id="value"
          formControlName="value"
          mode="currency"
          currency="USD"
          locale="en-US"
          placeholder="0.00"
          styleClass="w-full"
          [class.ng-invalid]="dealForm.get('value')?.invalid && dealForm.get('value')?.touched">
        </p-inputNumber>
        @if (dealForm.get('value')?.invalid && dealForm.get('value')?.touched) {
          <small class="p-error">Value is required</small>
        }
      </div>
      
      <div class="field">
        <label for="stage" class="block text-sm font-medium text-gray-700 mb-2">Stage *</label>
        <select
          id="stage"
          formControlName="stage"
          class="p-inputtext p-component w-full">
          <option value="lead">Lead</option>
          <option value="qualified">Qualified</option>
          <option value="proposal">Proposal</option>
          <option value="negotiation">Negotiation</option>
          <option value="closed_won">Closed Won</option>
          <option value="closed_lost">Closed Lost</option>
        </select>
        @if (dealForm.get('stage')?.invalid && dealForm.get('stage')?.touched) {
          <small class="p-error">Stage is required</small>
        }
      </div>
    </div>
    
    <div class="field">
      <label for="expectedCloseDate" class="block text-sm font-medium text-gray-700 mb-2">Expected Close Date</label>
      <input
        type="date"
        id="expectedCloseDate"
        formControlName="expectedCloseDate"
        class="p-inputtext p-component w-full">
    </div>
  </form>
  
  <ng-template pTemplate="footer">
    <p-button 
      label="Cancel" 
      icon="pi pi-times" 
      severity="secondary"
      [text]="true"
      (onClick)="onCancel()">
    </p-button>
    <p-button 
      [label]="selectedDeal() ? 'Update' : 'Save'"
      icon="pi pi-check" 
      [disabled]="dealForm.invalid"
      (onClick)="onSubmit()">
    </p-button>
  </ng-template>
</p-dialog>
